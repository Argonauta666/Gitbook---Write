---
description: aircrackng
---

# WiFi Pentesting

For our Wireless Access Points (APs), like our home networks, we all know that there is a password required to access protected networks. Specifically, there are 5 different authentication methods that can be used to ensure that our WiFi stays safe.&#x20;

* WEP
* WPA
* WPA2
* WPA3&#x20;
* WPS (technically, a feature of WiFi)

## Wireless Adapters

To attack Wifi, we would need to make use of something called **packet injection.** When running Linux machines as a a VM, we would not have access to this feature. We would need something called a Wireless Adapter, and specifically one that allows **monitor mode.** Monitor mode would allow us to basically inject packets.

Personally, I the D-LINK DWA-192, which is this Death Star looking one, but you can use any of them. Here's a link to all the adapters that have monitor mode enabled:

{% embed url="https://kalitut.com/usb-wi-fi-adapters-supporting-monitor/" %}

Afterwards, we can configure the adapter accordingly like so:

```bash
iw dev <interface_name> interface add mon0 type monitor # add new network interface with monitor mode
iwconfig mon0 # check new interface
iw del mon0 interface del # delete new interface
systemctl restart NetworkManager.service # restart network manager
ifconfig <interface_name> down # turn off monitor mode
```

## WEP (Deprecated)

Wired Equivalent Privacy is a security algorithm for wireless networks. This algorithm secures wireless data transmissions and supports end to end encryption and authentication for access points. WEP was created to prevent Man-in-the-middle (MITM) attacks, which it did, for a while.&#x20;

WEP encrypts traffic using a 40, 64 or 128-bit key in hex, which is a **static key**. This means all traffic, regardless of device, is encrypted using a single key. WEP was retired in 2004 and is considered obsolete today, although sometimes it is still used in very, very outdated networks that don't have the hardware to support WPA (which is really rare today).&#x20;

This is how WEP works:

<figure><img src="../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

This algorithm uses a key and an Initialisation Vector (IV), which would 24-bits and pseudo-randomly generated. How authentication mechanisms work is illustrated as follows:

<figure><img src="../.gitbook/assets/image (1).png" alt=""><figcaption></figcaption></figure>

The challenge response we send back is the WEP password. After authentication, the pre-shared WEP key would be used to encrypt data frames sent back and forth via RC4 algorithm.&#x20;

WEP is really old and broken, so loads of tools have automated exploits for it, like **airgeddon** and its  all-in-one WEP attacks, which would basically do everything for you. I will just explain some attack methods below.

{% embed url="https://github.com/v1s1t0r1sh3r3/airgeddon" %}

### Passive Attacks

Because the key for WEP is static, and only the IV is randomly generated, it would mean that as packets are generated and encrypted, there is a high probability that there would be **IV Collision**, which means two packets are encrypted using the same key and IV.&#x20;

The passive attack would then revolve around **passively intercepting all wireless traffic** and collecting packets and trying to observe which packets have the same IV used. By XOR-ing those packets together, we can obtain the XOR of the two plaintext messages.&#x20;

In short, we can sit there, collect packets and then break the WiFi Password easily. Once we have the Wifi password, we can gain access to a network, listen for more cleartext packets and so on.&#x20;

### Active Attacks

#### ARP Replay

The ARP replay is when the attacker listens for an ARP packet and retransmits that back to the access point. This would cause the AP to repeat the ARP packet with a new IV. The attacker can then keep collecting these new packets, and afterwards be able to crack it with aircrack-ng or something.

## WPA vs WPA2&#x20;

Wi-Fi Protected Access Versions 1 and 2 are protocols that were created to counter the problems with WEP. WPA was available in 2003, and WPA2 was available in 2004. WPA2, despite being outdated, is still used today.

The difference between the two is that WPA uses something called **Temporal Key Integrity Protocol** (TKIP) to encrypt its traffic. WPA also still incorporates the weak RC4 algorithm, bnut this time uses longer IVs and 256-bit keys. The implemetnation of TKIP would help with generation of new keys. Enterprise mode for WPA basically has stronger authentication via 802.1x and EAP.&#x20;

WPA2 uses AES instead of TKIP to encrypt the traffic, which is a very strong symmetric encryption algorithm relative to TKIP. WPA2 also replaces RC4 with something stronger called CCMP.&#x20;

